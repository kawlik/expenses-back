import{r as m,j as e,a as R,F as y,b as o,d as $,c as B,e as z,f as S,g as E,h as F,i as M,k as W,l as O,m as q,n as T,o as Z,R as H,p as Y}from"./vendor.6b253f40.js";const V=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function a(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=a(i);fetch(i.href,s)}};V();var c={API:{host:"https://expenses-kawlik.herokuapp.com",auth:{facebook:"https://expenses-kawlik.herokuapp.com/auth/facebook"},link:{expense:{get:{findAllBy_listID:"/expense/list/"},post:{addNewBy_listID:"/expense/add/"},put:{argueBy_expenseID:"/expense/argue/"}},list:{get:{findAllBy_userID:"/list/all/"},post:{addNewBy_userID:"/list/add/"},put:{lockBy_listID:"/list/lock/"}},user:{get:{findOneBy_auth:"/user/auth/",findAllBy_name:"/user/name/",findOneBy_userID:"/user/id/"},put:{addNewAsFriendBy_userID:"/user/add/",romoveUserAsFriend_userID:"/user/remove/"}}}},views:{list:["saved","active","profile"],name:{saved:"saved",active:"active",profile:"profile"}}};const w=m.exports.createContext(null),X=({children:t})=>{const[n,a]=m.exports.useState(null),[r,i]=m.exports.useState(null),[s,l]=m.exports.useState(!1),p={user:n,setUser:a,list:r,setList:i,load:s,setLoad:l};return m.exports.useEffect(()=>()=>{},[]),e(w.Provider,{value:p,children:t})},L=(t,n="")=>c.API.host+t+n,x=async(t,n)=>{try{const a=await R.get(L(t,n)),r=a==null?void 0:a.data;if(r==null?void 0:r.success)return r.response;throw new Error("Request could not be processed!")}catch(a){return console.error(a),null}},D=async(t,n,a)=>{try{const r=await R.post(L(t,n),a),i=r==null?void 0:r.data;if(i==null?void 0:i.success)return i.response;throw new Error("Request could not be processed!")}catch(r){return console.error(r),null}},_=async(t,n,a)=>{try{const r=await R.put(L(t,n),a),i=r==null?void 0:r.data;if(i==null?void 0:i.success)return i.response;throw new Error("Request could not be processed!")}catch(r){return console.error(r),null}},I=async t=>{try{const n=[];for(const a of t.friends){const r=await x(c.API.link.user.get.findOneBy_userID,a);n.push(r)}return n}catch(n){return console.error(n),null}},K=()=>{const{setUser:t,setList:n}=m.exports.useContext(w),a=s=>{if(document.cookie!==""){const l=document.cookie.split(/; */);for(const p of l){const[u,v]=p.split("=");if(u===decodeURIComponent(s))return!0}}return!1},r=s=>{const l=document.cookie.split(/; */);for(const p of l){const[u,v]=p.split("=");if(u===decodeURIComponent(s))return v}},i=async s=>{try{const l=await x(c.API.link.user.get.findOneBy_auth,s);if(s===(l==null?void 0:l.auth)){l.friends=await I(l);const p=await x(c.API.link.list.get.findAllBy_userID,l._id);for(const u of p)u.userA=await x(c.API.link.user.get.findOneBy_userID,u.userA),u.userB=await x(c.API.link.user.get.findOneBy_userID,u.userB),u.expenses=await x(c.API.link.expense.get.findAllBy_listID,u._id);t(l),n(p)}}catch(l){return console.error(l)}};return m.exports.useEffect(()=>{if(window.history.replaceState(null,document.title,window.location.pathname),a("auth")){const s=r("auth");i(s)}},[]),e(y,{children:e("div",{className:"modal modal-signin position-static d-block bg-light py-5",children:e("div",{className:"modal-dialog",children:e("div",{className:"modal-content shadow",style:{borderRadius:"15px"},children:o("div",{className:"modal-body p-4",children:[e("h2",{className:"fw-bold p-2 mb-4",children:"Logowanie"}),o("a",{href:c.API.auth.facebook,className:"w-100 btn btn-lg btn-outline-primary mb-2",type:"button",style:{borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e($,{style:{fontSize:"32px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Zaloguj z Facebook"})]}),e("hr",{className:"mb-3"}),e("small",{className:"text-muted",children:"Do zalogowania si\u0119 konieczne jest skorzystanie z wybranego serwisu spo\u0142eczno\u015Bciowego. Korzystanie z takiej metody logowania zwi\u0119ksza bezpiecze\u0144stwo i zmniejsza ilo\u015B\u0107 koniecznych do zapami\u0119tania hase\u0142."})]})})})})})},C=({user:t,action:n})=>e(y,{children:o("li",{className:"list-group-item shadow-sm p-1",style:{borderRadius:"10px"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.body.picture,alt:t.body.name,style:{width:"32px",height:" 32px",borderRadius:"32px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"20px",fontWeight:"300"},children:t.body.name}),e("button",{type:"button",className:"btn btn-outline-success py-1 px-3",onClick:a=>n(a,t._id),style:{borderRadius:"10px",float:"right"},children:e(B,{style:{verticalAlign:"middle"}})})]})}),G=()=>{const{user:t,setList:n}=m.exports.useContext(w),a=async(r,i)=>{r.preventDefault(),r.target.closest("button").classList.add("loading");try{const s=await D(c.API.link.list.post.addNewBy_userID,i,{auth:t.auth});s.userA=await x(c.API.link.user.get.findOneBy_userID,s.userA),s.userB=await x(c.API.link.user.get.findOneBy_userID,s.userB),s.expenses=await x(c.API.link.expense.get.findAllBy_listID,s._id),n(l=>[...l,s])}catch(s){return r.target.closest("button").classList.remove("loading"),console.error(s)}r.target.closest("button").classList.remove("loading")};return e(y,{children:o("section",{className:"p-2 border mt-5 shadow",style:{borderRadius:"10px"},children:[e("h2",{className:"fw-bold fs-5 mb-3",children:"Dodaj nowe rozliczenie"}),e("ul",{className:"list-group border p-1 mb-2",style:{overflowY:"scroll",maxHeight:"40vh",borderRadius:"10px"},children:t.friends.length?t.friends.map(r=>e(C,{user:r,action:i=>a(i,r._id)},r._id)):e("h3",{className:"fw-light fs-4 mt-5 mx-2 text-center",children:"Dodaj znajomych, by m\xF3c towrzy\u0107 rozliczenia!"})})]})})},J=({list:t})=>{const{user:n,setList:a}=m.exports.useContext(w),[r,i]=m.exports.useState(""),[s,l]=m.exports.useState(""),[p,u]=m.exports.useState(""),v=d=>{i(d.target.value)},k=d=>{l(Math.min(d.target.value,1e4)==0?"":Math.min(d.target.value,1e4))},N=d=>{u(d.target.value)},h=async d=>{d.preventDefault(),d.target.closest("button").classList.add("loading");const g={auth:n.auth,data:{_id_list:t._id,user:p,name:r,value:s}};try{const b=await D(c.API.link.expense.post.addNewBy_listID,t._id,g);t.expenses.push(b),a(A=>[...A.filter(f=>f._id!==t._id),t]),u(""),l(""),i("")}catch(b){return d.target.closest("button").classList.remove("loading"),console.error(b)}d.target.closest("button").classList.remove("loading")};return e(y,{children:o("div",{className:"row my-1 py-1",children:[e("div",{className:"col-12 mb-3",children:o("select",{value:p,onChange:N,className:"form-select",style:{height:"42px",borderRadius:"10px"},children:[e("option",{value:"",hidden:!0,children:"Wybierz osob\u0119 z listy"}),e("option",{value:t.userA._id,children:t.userA.body.name}),e("option",{value:t.userB._id,children:t.userB.body.name})]})}),e("div",{className:"col-12 mb-3",children:e("input",{value:r,onChange:v,type:"text",className:"form-control",placeholder:"Wydatek",style:{height:"42px",borderRadius:"10px"}})}),o("div",{className:"col-12 mb-3 input-group",children:[e("input",{value:s,onChange:k,min:1,max:1e4,step:1,type:"number",className:"form-control",placeholder:"Cena",style:{height:"42px",borderTopLeftRadius:"10px",borderBottomLeftRadius:"10px"}}),e("span",{className:"input-group-text",style:{height:"42px",borderTopRightRadius:"10px",borderBottomRightRadius:"10px"},children:".00"})]}),e("div",{className:"col-12",children:o("button",{disabled:r===""||s===""||p==="",onClick:h,type:"button",className:"btn btn-outline-success w-100",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(B,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Dodaj"})]})})]})})},P=({list:t})=>{const n=t.expenses.filter(s=>s.user===t.userA._id).map(s=>s.value),a=t.expenses.filter(s=>s.user===t.userB._id).map(s=>s.value),r=n.length?n.reduce((s,l)=>s+l):0,i=a.length?a.reduce((s,l)=>s+l):0;return o(y,{children:[e("h4",{className:"lead",children:t.date.split("T")[0]}),o("div",{className:"py-1 w-100",children:[o("span",{className:"badge bg-info",style:{verticalAlign:"middle",marginRight:"10px",minWidth:"84px",height:" 32px",textAlign:"left"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"5px"},children:e(z,{})}),e("span",{style:{verticalAlign:"middle"},children:r})]}),e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.userA.body.picture,alt:t.userA.body.name,style:{width:"32px",height:" 32px",borderRadius:"32px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"20px",fontWeight:"300"},children:t.userA.body.name})]}),o("div",{className:"py-1 w-100",children:[o("span",{className:"badge bg-info",style:{verticalAlign:"middle",marginRight:"10px",minWidth:"84px",height:" 32px",textAlign:"left"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"5px"},children:e(z,{})}),e("span",{style:{verticalAlign:"middle"},children:i})]}),e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.userB.body.picture,alt:t.userB.body.name,style:{width:"32px",height:" 32px",borderRadius:"32px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"20px",fontWeight:"300"},children:t.userB.body.name})]})]})},j=({list:t})=>e(y,{children:t.expenses.map(n=>o("figure",{className:"m-1 p-1 shadow-sm rounded",children:[o("blockquote",{className:"blockquote",children:[o("span",{className:"badge bg-secondary",style:{verticalAlign:"middle",marginRight:"10px",minWidth:"84px",height:" 32px",textAlign:"left"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"5px"},children:e(z,{})}),e("span",{style:{verticalAlign:"middle"},children:n.value})]}),e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:n.name})]}),e("figcaption",{className:"blockquote-footer",children:t.userA._id===n.user?t.userA.body.name:t.userB.body.name})]},n._id))}),Q=({list:t})=>{const{user:n,setList:a}=m.exports.useContext(w),r=async s=>{s.preventDefault(),s.target.closest("button").classList.add("loading");try{const l=await _(c.API.link.list.put.lockBy_listID,t._id,{auth:n.auth,lock:!0});t.status=l.status,a(p=>[...p.filter(u=>u._id!==t._id),t])}catch(l){return s.target.closest("button").classList.remove("loading"),console.error(l)}s.target.closest("button").classList.remove("loading")},i=async s=>{s.preventDefault(),s.target.closest("button").classList.add("loading");try{const l=await _(c.API.link.list.put.lockBy_listID,t._id,{auth:n.auth,lock:!1});t.status=l.status,a(p=>[...p.filter(u=>u._id!==t._id),t])}catch(l){return s.target.closest("button").classList.remove("loading"),console.error(l)}s.target.closest("button").classList.remove("loading")};return e(y,{children:o("div",{className:"mb-3 border p-2 shadow",style:{borderRadius:"10px"},children:[e(P,{list:t}),o("details",{className:"py-1 w-100 my-2",children:[o("summary",{className:"btn btn-outline-secondary w-100",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(S,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Wi\u0119cej"})]}),t.status.locked?null:o("div",{className:"py-1 w-100 mt-4",children:[e("h5",{className:"lead",children:"Dodaj nowy wydatek"}),e(J,{list:t})]}),o("div",{className:"py-1 mt-4 w-100",children:[e("h5",{className:"lead",children:"Zapisane wydatki"}),e(j,{list:t})]})]}),t.status.locked?o("h3",{className:"fw-light fs-5 mt-5 text-center",children:["U\u017Cytkownik ",t.status.lockUserA?t.userA.body.name:t.userB.body.name," wys\u0142a\u0142 propozycj\u0119, by zako\u0144czy\u0107 dane rozliczenie. Czy chcesz zako\u0144czy\u0107?"]}):null,t.status.locked?o("button",{onClick:i,className:"w-100 btn btn-outline-success mt-2",type:"button",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(E,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Rozliczaj dalej"})]}):null,t.status.locked&&t.status.lockUserA&&t.userA._id===n._id||t.status.locked&&t.status.lockUserB&&t.userB._id===n._id?null:o("button",{onClick:r,className:"w-100 btn btn-outline-danger mt-2",type:"button",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(F,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Zako\u0144cz teraz"})]})]})})},ee=()=>{const{list:t}=m.exports.useContext(w),n=t.filter(a=>!a.status.finished);return o(y,{children:[n.length?n.map(a=>e(Q,{list:a},a._id)):e("h3",{className:"fw-light fs-4 mt-5 mx-2 text-center",children:"Tu pojawiaj\u0105 si\u0119 aktywne rozliczenia z innymi u\u017Cytkownikami."}),e(G,{})]})},te=({user:t,action:n})=>o(y,{children:[o("li",{className:"w-100 mb-2 shadow-sm rounded p-1",style:{listStyle:"none"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.body.picture,alt:t.body.name,style:{width:"36px",height:"36px",borderRadius:"36px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"26px",fontWeight:"300"},children:t.body.name}),e("button",{type:"button",className:"btn btn-outline-danger py-1 px-3",onClick:a=>n(a,t._id),style:{borderRadius:"10px",float:"right"},children:e(M,{style:{verticalAlign:"middle"}})})]}),e("hr",{className:"mb-3",style:{height:"0.5px"}})]}),se=()=>{const{user:t,setUser:n,setList:a,setLoad:r}=m.exports.useContext(w),[i,s]=m.exports.useState(""),[l,p]=m.exports.useState([]),u=async h=>{const d=h.target.value;s(d);try{if(d.length>=3){const A=(await x(c.API.link.user.get.findAllBy_name+d)).filter(f=>f._id!==t._id).filter(f=>{for(const{_id:U}of t.friends)if(U===f._id)return!1;return!0});p(A)}else p([])}catch(g){return console.error(g)}},v=async(h,d)=>{h.preventDefault(),h.target.closest("button").classList.add("loading");try{const g=await _(c.API.link.user.put.addNewAsFriendBy_userID,d,{auth:t.auth});t.friends=await I(g),s(""),p([])}catch(g){return h.target.closest("button").classList.remove("loading"),console.error(g)}h.target.closest("button").classList.remove("loading")},k=async(h,d)=>{h.preventDefault(),h.target.closest("button").classList.add("loading");try{const g=await _(c.API.link.user.put.romoveUserAsFriend_userID,d,{auth:t.auth});t.friends=await I(g),s(""),p([])}catch(g){return h.target.closest("button").classList.remove("loading"),console.error(g)}h.target.closest("button").classList.remove("loading")},N=h=>{h.preventDefault(),h.target.closest("button").classList.add("loading");const d=document.cookie.split(/; */);for(const g of d){const[b,A]=g.split("=");document.cookie=b+`=;expires${Date.now()-1}`}n(null),a(null),r(!1),h.target.closest("button").classList.remove("loading")};return o(y,{children:[o("section",{className:"mb-3 w-100 p-2",children:[e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.body.picture,alt:t.body.name,style:{width:"50px",height:" 50px",borderRadius:"50px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"32px",fontWeight:"300"},children:t.body.name}),o("button",{onClick:N,className:"w-100 btn btn-outline-danger mt-3",type:"button",style:{borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(W,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Wyloguj"})]}),e("hr",{}),o("div",{className:"input-group",children:[e("input",{value:i,onChange:u,type:"text",className:"form-control",placeholder:"Wyszukaj znajomego",style:{height:"42px",borderTopLeftRadius:"10px",borderBottomLeftRadius:"10px"}}),e("span",{className:"input-group-text",style:{height:"42px",borderTopRightRadius:"10px",borderBottomRightRadius:"10px"},children:e(O,{})})]}),l.length?e("div",{className:"my-2",children:e("ul",{className:"list-group border p-1 mb-2",style:{overflowY:"scroll",maxHeight:"40vh",borderRadius:"10px"},children:l.map(h=>e(C,{user:h,action:v},h._id))})}):null]}),o("section",{className:"w-100 p-2",children:[e("h2",{className:"display-6",children:"Znajomi"}),t.friends.map(h=>e(te,{user:h,action:k},h._id))]})]})},ne=({list:t})=>e(y,{children:o("div",{className:"mb-3 border p-2 shadow",style:{borderRadius:"10px"},children:[e(P,{list:t}),o("details",{className:"py-1 w-100 mt-2",children:[o("summary",{className:"btn btn-outline-secondary w-100",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(S,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Wi\u0119cej"})]}),o("div",{className:"py-1 w-100 mt-4",children:[e("h5",{className:"lead",children:"Zapisane wydatki"}),e(j,{list:t})]})]})]})}),ae=()=>{const{list:t}=m.exports.useContext(w),n=t.filter(a=>a.status.finished);return e(y,{children:n.length?n.map(a=>e(ne,{list:a},a._id)):e("h3",{className:"fw-light fs-4 mt-5 mx-2 text-center",children:"Tu pojawiaj\u0105 si\u0119 zako\u0144czone przez Ciebie rozliczenia."})})},ie=({view:t,setView:n,setSwipe:a})=>e(y,{children:o("nav",{className:"nav navbar-dark bg-light row p-2 w-100",id:"view-selector",children:[e("li",{className:`col-3 row mx-auto  ${t===c.views.name.saved&&"active"}`,children:o("button",{className:"mx-auto btn pb-3",onClick:()=>{n(c.views.name.saved),a(null)},children:[e(q,{style:{fontSize:"28px"}}),e("small",{children:"Zapisane"})]})}),e("li",{className:`col-3 row mx-auto ${t===c.views.name.active&&"active"}`,children:o("button",{className:"mx-auto btn pb-3",onClick:()=>{n(c.views.name.active),a(null)},children:[e(T,{style:{fontSize:"28px"}}),e("small",{children:"Aktywne"})]})}),e("li",{className:`col-3 row mx-auto ${t===c.views.name.profile&&"active"}`,children:o("button",{className:"mx-auto btn pb-3",onClick:()=>{n(c.views.name.profile),a(null)},children:[e(Z,{style:{fontSize:"28px"}}),e("small",{children:"Profil"})]})})]})}),re=()=>{const[t,n]=m.exports.useState(c.views.name.profile),[a,r]=m.exports.useState(null),i={x:null,y:null},s=u=>{i.x=u.touches[0].clientX,i.y=u.touches[0].clientY},l=u=>{if(!i.x||!i.y)return;const v=Math.min(window.innerWidth/3,300),k=.33,N=u.touches[0].clientX,h=u.touches[0].clientY,d=i.x-N,g=i.y-h;if(Math.abs(d)>Math.abs(g)){const b=d<=0?1:-1,A=Math.max(1-(Math.abs(d)-Math.abs(g))/v,0),f=b*k*(Math.abs(d)-Math.abs(g));document.querySelector("#view-content").style.transition=null,document.querySelector("#view-content").style.opacity=A,document.querySelector("#view-content").style.transform=`translateX( ${f}px )`}if(Math.abs(d)>Math.abs(g)&&Math.abs(d)-Math.abs(g)>v){const b=0,A=c.views.list.length-1,f=c.views.list.indexOf(t);d<0&&f-1>=b&&(n(c.views.list[f-1]),r("left")),d>0&&f+1<=A&&(n(c.views.list[f+1]),r("right"))}},p=u=>{document.querySelector("#view-content").style.opacity=1,document.querySelector("#view-content").style.transition="all ease-in-out 0.3s",document.querySelector("#view-content").style.transform=null};return m.exports.useEffect(()=>(document.addEventListener("touchstart",s),document.addEventListener("touchmove",l),document.addEventListener("touchend",p),()=>{document.removeEventListener("touchstart",s),document.removeEventListener("touchmove",l),document.removeEventListener("touchend",p)}),[t]),e(y,{children:o("main",{id:"view-container",children:[o("section",{id:"view-content",className:`p-2 w-100 ${a}`,children:[t===c.views.name.saved&&e(ae,{}),t===c.views.name.active&&e(ee,{}),t===c.views.name.profile&&e(se,{})]},t),e(ie,{view:t,setView:n,setSwipe:r})]})})},le=()=>{const{user:t}=m.exports.useContext(w);return e(y,{children:t?e(re,{}):e(K,{})})};const oe=()=>e(X,{children:e(le,{})});H.render(e(Y.StrictMode,{children:e(oe,{})}),document.getElementById("root"));
