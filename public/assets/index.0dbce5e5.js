import{r as h,j as e,a as R,F as y,b as o,d as E,c as L,e as z,f as S,g as M,h as U,i as $,k as F,l as O,m as W,n as q,R as T,o as Z}from"./vendor.663690b7.js";const H=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}};H();var c={API:{host:"https://expenses-kawlik.herokuapp.com",auth:{facebook:"https://expenses-kawlik.herokuapp.com/auth/facebook"},link:{expense:{get:{findAllBy_listID:"/expense/list/"},post:{addNewBy_listID:"/expense/add/"},put:{argueBy_expenseID:"/expense/argue/"}},list:{get:{findAllBy_userID:"/list/all/"},post:{addNewBy_userID:"/list/add/"},put:{lockBy_listID:"/list/lock/"}},user:{get:{findOneBy_auth:"/user/auth/",findAllBy_name:"/user/name/",findOneBy_userID:"/user/id/"},put:{addNewAsFriendBy_userID:"/user/add/",romoveUserAsFriend_userID:"/user/remove/"}}}},views:{list:["saved","active","profile"],name:{saved:"saved",active:"active",profile:"profile"}}};const b=h.exports.createContext(null),Y=({children:t})=>{const[n,r]=h.exports.useState(null),[a,i]=h.exports.useState(null),[s,l]=h.exports.useState(!1),p={user:n,setUser:r,list:a,setList:i,load:s,setLoad:l};return h.exports.useEffect(()=>()=>{},[]),e(b.Provider,{value:p,children:t})},I=(t,n="")=>c.API.host+t+n,x=async(t,n)=>{try{const r=await R.get(I(t,n)),a=r==null?void 0:r.data;if(a==null?void 0:a.success)return a.response;throw new Error("Request could not be processed!")}catch(r){return console.error(r),null}},D=async(t,n,r)=>{try{const a=await R.post(I(t,n),r),i=a==null?void 0:a.data;if(i==null?void 0:i.success)return i.response;throw new Error("Request could not be processed!")}catch(a){return console.error(a),null}},_=async(t,n,r)=>{try{const a=await R.put(I(t,n),r),i=a==null?void 0:a.data;if(i==null?void 0:i.success)return i.response;throw new Error("Request could not be processed!")}catch(a){return console.error(a),null}},B=async t=>{try{const n=[];for(const r of t.friends){const a=await x(c.API.link.user.get.findOneBy_userID,r);n.push(a)}return n}catch(n){return console.error(n),null}},V=()=>{const{setUser:t,setList:n}=h.exports.useContext(b),r=s=>{if(document.cookie!==""){const l=document.cookie.split(/; */);for(const p of l){const[d,u]=p.split("=");if(d===decodeURIComponent(s))return!0}}return!1},a=s=>{const l=document.cookie.split(/; */);for(const p of l){const[d,u]=p.split("=");if(d===decodeURIComponent(s))return u}},i=async s=>{try{const l=await x(c.API.link.user.get.findOneBy_auth,s);if(s===(l==null?void 0:l.auth)){l.friends=await B(l);const p=await x(c.API.link.list.get.findAllBy_userID,l._id);for(const d of p)d.userA=await x(c.API.link.user.get.findOneBy_userID,d.userA),d.userB=await x(c.API.link.user.get.findOneBy_userID,d.userB),d.expenses=await x(c.API.link.expense.get.findAllBy_listID,d._id);t(l),n(p)}}catch(l){return console.error(l)}};return h.exports.useEffect(()=>{if(window.history.replaceState(null,document.title,window.location.pathname),r("auth")){const s=a("auth");i(s)}},[]),e(y,{children:e("div",{className:"modal modal-signin position-static d-block bg-light py-5",children:e("div",{className:"modal-dialog",children:e("div",{className:"modal-content shadow",style:{borderRadius:"15px"},children:o("div",{className:"modal-body p-4",children:[e("h2",{className:"fw-bold p-2 mb-4",children:"Logowanie"}),o("a",{href:c.API.auth.facebook,className:"w-100 btn btn-lg btn-outline-primary mb-2",type:"button",style:{borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(E,{style:{fontSize:"32px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Zaloguj z Facebook"})]}),e("hr",{className:"mb-3"}),e("small",{className:"text-muted",children:"Do zalogowania si\u0119 konieczne jest skorzystanie z wybranego serwisu spo\u0142eczno\u015Bciowego. Korzystanie z takiej metody logowania zwi\u0119ksza bezpiecze\u0144stwo i zmniejsza ilo\u015B\u0107 koniecznych do zapami\u0119tania hase\u0142."})]})})})})})},C=({user:t,action:n})=>e(y,{children:o("li",{className:"list-group-item shadow-sm p-1",style:{borderRadius:"10px"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.body.picture,alt:t.body.name,style:{width:"32px",height:" 32px",borderRadius:"32px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"20px",fontWeight:"300"},children:t.body.name}),e("button",{type:"button",className:"btn btn-outline-success py-1 px-3",onClick:r=>n(r,t._id),style:{borderRadius:"10px",float:"right"},children:e(L,{style:{verticalAlign:"middle"}})})]})}),X=()=>{const{user:t,setList:n}=h.exports.useContext(b),r=async(a,i)=>{a.preventDefault(),a.target.closest("button").classList.add("loading");try{const s=await D(c.API.link.list.post.addNewBy_userID,i,{auth:t.auth});s.userA=await x(c.API.link.user.get.findOneBy_userID,s.userA),s.userB=await x(c.API.link.user.get.findOneBy_userID,s.userB),s.expenses=await x(c.API.link.expense.get.findAllBy_listID,s._id),n(l=>[...l,s])}catch(s){return a.target.closest("button").classList.remove("loading"),console.error(s)}a.target.closest("button").classList.remove("loading")};return e(y,{children:o("section",{className:"p-2 border mt-5 shadow",style:{borderRadius:"10px"},children:[e("h2",{className:"fw-bold fs-5 mb-3",children:"Dodaj nowe rozliczenie"}),e("ul",{className:"list-group border p-1 mb-2",style:{overflowY:"scroll",maxHeight:"40vh",borderRadius:"10px"},children:t.friends.length?t.friends.map(a=>e(C,{user:a,action:i=>r(i,a._id)},a._id)):e("h3",{className:"fw-light fs-4 mt-5 mx-2 text-center",children:"Dodaj znajomych, by m\xF3c towrzy\u0107 rozliczenia!"})})]})})},K=({list:t})=>{const{user:n,setList:r}=h.exports.useContext(b),[a,i]=h.exports.useState(""),[s,l]=h.exports.useState(""),[p,d]=h.exports.useState(""),u=m=>{i(m.target.value)},f=m=>{l(Math.min(m.target.value,1e4)==0?"":Math.min(m.target.value,1e4))},g=m=>{d(m.target.value)},k=async m=>{m.preventDefault(),m.target.closest("button").classList.add("loading");const w={auth:n.auth,data:{_id_list:t._id,user:p,name:a,value:s}};try{const A=await D(c.API.link.expense.post.addNewBy_listID,t._id,w);t.expenses.push(A),r(N=>[...N.filter(v=>v._id!==t._id),t]),d(""),l(""),i("")}catch(A){return m.target.closest("button").classList.remove("loading"),console.error(A)}m.target.closest("button").classList.remove("loading")};return e(y,{children:o("div",{className:"row my-1 py-1",children:[e("div",{className:"col-12 mb-3",children:o("select",{value:p,onChange:g,className:"form-select",style:{height:"42px",borderRadius:"10px"},children:[e("option",{value:t.userA._id,children:t.userA.body.name}),e("option",{value:t.userB._id,children:t.userB.body.name})]})}),e("div",{className:"col-12 mb-3",children:e("input",{value:a,onChange:u,type:"text",className:"form-control",placeholder:"Wydatek",style:{height:"42px",borderRadius:"10px"}})}),o("div",{className:"col-12 mb-3 input-group",children:[e("input",{value:s,onChange:f,min:1,max:1e4,step:1,type:"number",className:"form-control",placeholder:"Cena",style:{height:"42px",borderTopLeftRadius:"10px",borderBottomLeftRadius:"10px"}}),e("span",{className:"input-group-text",style:{height:"42px",borderTopRightRadius:"10px",borderBottomRightRadius:"10px"},children:".00"})]}),e("div",{className:"col-12",children:o("button",{disabled:a===""||s===""||p==="",onClick:k,type:"button",className:"btn btn-outline-success w-100",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(L,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Dodaj"})]})})]})})},P=({list:t})=>{const n=t.expenses.filter(s=>s.user===t.userA._id).map(s=>s.value),r=t.expenses.filter(s=>s.user===t.userB._id).map(s=>s.value),a=n.length?n.reduce((s,l)=>s+l):0,i=r.length?r.reduce((s,l)=>s+l):0;return o(y,{children:[e("h4",{className:"lead",children:t.date.split("T")[0]}),o("div",{className:"py-1 w-100",children:[o("span",{className:"badge bg-info",style:{verticalAlign:"middle",marginRight:"10px",minWidth:"84px",height:" 32px",textAlign:"left"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"5px"},children:e(z,{})}),e("span",{style:{verticalAlign:"middle"},children:a})]}),e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.userA.body.picture,alt:t.userA.body.name,style:{width:"32px",height:" 32px",borderRadius:"32px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"20px",fontWeight:"300"},children:t.userA.body.name})]}),o("div",{className:"py-1 w-100",children:[o("span",{className:"badge bg-info",style:{verticalAlign:"middle",marginRight:"10px",minWidth:"84px",height:" 32px",textAlign:"left"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"5px"},children:e(z,{})}),e("span",{style:{verticalAlign:"middle"},children:i})]}),e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.userB.body.picture,alt:t.userB.body.name,style:{width:"32px",height:" 32px",borderRadius:"32px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"20px",fontWeight:"300"},children:t.userB.body.name})]})]})},j=({list:t})=>e(y,{children:t.expenses.map(n=>o("figure",{className:"m-1 p-1 shadow-sm rounded",children:[o("blockquote",{className:"blockquote",children:[o("span",{className:"badge bg-secondary",style:{verticalAlign:"middle",marginRight:"10px",minWidth:"84px",height:" 32px",textAlign:"left"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"5px"},children:e(z,{})}),e("span",{style:{verticalAlign:"middle"},children:n.value})]}),e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:n.name})]}),e("figcaption",{className:"blockquote-footer",children:t.userA._id===n.user?t.userA.body.name:t.userB.body.name})]},n._id))}),G=({list:t})=>{console.log(t);const{user:n,setList:r}=h.exports.useContext(b),a=async s=>{s.preventDefault(),s.target.closest("button").classList.add("loading");try{const l=await _(c.API.link.list.put.lockBy_listID,t._id,{auth:n.auth,lock:!0});t.status=l.status,r(p=>[...p.filter(d=>d._id!==t._id),t])}catch(l){return s.target.closest("button").classList.remove("loading"),console.error(l)}s.target.closest("button").classList.remove("loading")},i=async s=>{s.preventDefault(),s.target.closest("button").classList.add("loading");try{const l=await _(c.API.link.list.put.lockBy_listID,t._id,{auth:n.auth,lock:!1});t.status=l.status,r(p=>[...p.filter(d=>d._id!==t._id),t])}catch(l){return s.target.closest("button").classList.remove("loading"),console.error(l)}s.target.closest("button").classList.remove("loading")};return e(y,{children:o("div",{className:"mb-3 border p-2 shadow",style:{borderRadius:"10px"},children:[e(P,{list:t}),o("details",{className:"py-1 w-100 my-2",children:[o("summary",{className:"btn btn-outline-secondary w-100",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(S,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Wi\u0119cej"})]}),t.status.locked?null:o("div",{className:"py-1 w-100 mt-4",children:[e("h5",{className:"lead",children:"Dodaj nowy wydatek"}),e(K,{list:t})]}),o("div",{className:"py-1 mt-4 w-100",children:[e("h5",{className:"lead",children:"Zapisane wydatki"}),e(j,{list:t})]})]}),t.status.locked?o("h3",{className:"fw-light fs-5 mt-5 text-center",children:["U\u017Cytkownik ",t.status.lockUserA?t.userA.body.name:t.userB.body.name," wys\u0142a\u0142 propozycj\u0119, by zako\u0144czy\u0107 dane rozliczenie. Czy chcesz zako\u0144czy\u0107?"]}):null,t.status.locked?o("button",{onClick:i,className:"w-100 btn btn-outline-success mt-2",type:"button",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(M,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Rozliczaj dalej"})]}):null,t.status.locked&&t.status.lockUserA&&t.userA._id===n._id||t.status.locked&&t.status.lockUserB&&t.userB._id===n._id?null:o("button",{onClick:a,className:"w-100 btn btn-outline-danger mt-2",type:"button",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(U,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Zako\u0144cz teraz"})]})]})})},J=()=>{const{list:t}=h.exports.useContext(b),n=t.filter(r=>!r.status.finished);return o(y,{children:[n.length?n.map(r=>e(G,{list:r},r._id)):e("h3",{className:"fw-light fs-4 mt-5 mx-2 text-center",children:"Tu pojawiaj\u0105 si\u0119 aktywne rozliczenia z innymi u\u017Cytkownikami."}),e(X,{})]})},Q=({user:t,action:n})=>o(y,{children:[o("li",{className:"w-100 mb-2 shadow-sm rounded p-1",style:{listStyle:"none"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.body.picture,alt:t.body.name,style:{width:"42px",height:"42px",borderRadius:"42px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"28px",fontWeight:"300"},children:t.body.name}),e("button",{type:"button",className:"btn btn-outline-danger py-1 px-3",onClick:r=>n(r,t._id),style:{borderRadius:"10px",float:"right"},children:e($,{style:{verticalAlign:"middle"}})})]}),e("hr",{className:"mb-3",style:{height:"0.5px"}})]}),ee=()=>{const{user:t,setUser:n}=h.exports.useContext(b),[r,a]=h.exports.useState(""),[i,s]=h.exports.useState([]),l=async u=>{const f=u.target.value;a(f);try{if(f.length>=3){const g=await x(c.API.link.user.get.findAllBy_name+f);s(g.filter(k=>k._id!==t._id||!t.friend.includes(k)))}else s([])}catch(g){return console.error(g)}},p=async(u,f)=>{u.preventDefault(),u.target.closest("button").classList.add("loading");try{const g=await _(c.API.link.user.put.addNewAsFriendBy_userID,f,{auth:t.auth});t.friends=await B(g),a(""),s([])}catch(g){return u.target.closest("button").classList.remove("loading"),console.error(g)}u.target.closest("button").classList.remove("loading")},d=async(u,f)=>{u.preventDefault(),u.target.closest("button").classList.add("loading");try{const g=await _(c.API.link.user.put.romoveUserAsFriend_userID,f,{auth:t.auth});t.friends=await B(g),a(""),s([])}catch(g){return u.target.closest("button").classList.remove("loading"),console.error(g)}u.target.closest("button").classList.remove("loading")};return o(y,{children:[o("section",{className:"mb-3 w-100 p-2",children:[e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.body.picture,alt:t.body.name,style:{width:"50px",height:" 50px",borderRadius:"50px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"32px",fontWeight:"300"},children:t.body.name}),e("hr",{}),o("div",{className:"input-group",children:[e("input",{value:r,onChange:l,type:"text",className:"form-control",placeholder:"Wyszukaj znajomego",style:{height:"42px",borderTopLeftRadius:"10px",borderBottomLeftRadius:"10px"}}),e("span",{className:"input-group-text",style:{height:"42px",borderTopRightRadius:"10px",borderBottomRightRadius:"10px"},children:e(F,{})})]}),i.length?e("div",{className:"my-2",children:e("ul",{className:"list-group border p-1 mb-2",style:{overflowY:"scroll",maxHeight:"40vh",borderRadius:"10px"},children:i.map(u=>e(C,{user:u,action:p},u._id))})}):null]}),o("section",{className:"w-100 p-2",children:[e("h2",{className:"display-6",children:"Znajomi"}),t.friends.map(u=>e(Q,{user:u,action:d},u._id))]})]})},te=({list:t})=>e(y,{children:o("div",{className:"mb-3 border p-2 shadow",style:{borderRadius:"10px"},children:[e(P,{list:t}),o("details",{className:"py-1 w-100 mt-2",children:[o("summary",{className:"btn btn-outline-secondary w-100",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(S,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Wi\u0119cej"})]}),o("div",{className:"py-1 w-100 mt-4",children:[e("h5",{className:"lead",children:"Zapisane wydatki"}),e(j,{list:t})]})]})]})}),se=()=>{const{list:t}=h.exports.useContext(b),n=t.filter(r=>r.status.finished);return e(y,{children:n.length?n.map(r=>e(te,{list:r},r._id)):e("h3",{className:"fw-light fs-4 mt-5 mx-2 text-center",children:"Tu pojawiaj\u0105 si\u0119 zako\u0144czone przez Ciebie rozliczenia."})})},ne=({view:t,setView:n,setSwipe:r})=>e(y,{children:o("nav",{className:"nav navbar-dark bg-light row p-2 w-100",id:"view-selector",children:[e("li",{className:`col-3 row mx-auto  ${t===c.views.name.saved&&"active"}`,children:o("button",{className:"mx-auto btn pb-3",onClick:()=>{n(c.views.name.saved),r(null)},children:[e(O,{style:{fontSize:"28px"}}),e("small",{children:"Zapisane"})]})}),e("li",{className:`col-3 row mx-auto ${t===c.views.name.active&&"active"}`,children:o("button",{className:"mx-auto btn pb-3",onClick:()=>{n(c.views.name.active),r(null)},children:[e(W,{style:{fontSize:"28px"}}),e("small",{children:"Aktywne"})]})}),e("li",{className:`col-3 row mx-auto ${t===c.views.name.profile&&"active"}`,children:o("button",{className:"mx-auto btn pb-3",onClick:()=>{n(c.views.name.profile),r(null)},children:[e(q,{style:{fontSize:"28px"}}),e("small",{children:"Profil"})]})})]})}),ae=()=>{const[t,n]=h.exports.useState(c.views.name.profile),[r,a]=h.exports.useState(null),i={x:null,y:null},s=d=>{i.x=d.touches[0].clientX,i.y=d.touches[0].clientY},l=d=>{if(!i.x||!i.y)return;const u=Math.min(window.innerWidth/3,300),f=.33,g=d.touches[0].clientX,k=d.touches[0].clientY,m=i.x-g,w=i.y-k;if(Math.abs(m)>Math.abs(w)){const A=m<=0?1:-1,N=Math.max(1-(Math.abs(m)-Math.abs(w))/u,0),v=A*f*(Math.abs(m)-Math.abs(w));document.querySelector("#view-content").style.transition=null,document.querySelector("#view-content").style.opacity=N,document.querySelector("#view-content").style.transform=`translateX( ${v}px )`}if(Math.abs(m)>Math.abs(w)&&Math.abs(m)-Math.abs(w)>u){const A=0,N=c.views.list.length-1,v=c.views.list.indexOf(t);m<0&&v-1>=A&&(n(c.views.list[v-1]),a("left")),m>0&&v+1<=N&&(n(c.views.list[v+1]),a("right"))}},p=d=>{document.querySelector("#view-content").style.opacity=1,document.querySelector("#view-content").style.transition="all ease-in-out 0.3s",document.querySelector("#view-content").style.transform=null};return h.exports.useEffect(()=>(document.addEventListener("touchstart",s),document.addEventListener("touchmove",l),document.addEventListener("touchend",p),()=>{document.removeEventListener("touchstart",s),document.removeEventListener("touchmove",l),document.removeEventListener("touchend",p)}),[t]),e(y,{children:o("main",{id:"view-container",children:[o("section",{id:"view-content",className:`p-2 w-100 ${r}`,children:[t===c.views.name.saved&&e(se,{}),t===c.views.name.active&&e(J,{}),t===c.views.name.profile&&e(ee,{})]},t),e(ne,{view:t,setView:n,setSwipe:a})]})})},ie=()=>{const{user:t}=h.exports.useContext(b);return e(y,{children:t?e(ae,{}):e(V,{})})};const re=()=>e(Y,{children:e(ie,{})});T.render(e(Z.StrictMode,{children:e(re,{})}),document.getElementById("root"));
